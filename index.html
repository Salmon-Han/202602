<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 關東自駕行</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #0a0a0a; /* Deepest black/gray */
            color: #e5e5e5;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* Hide Scrollbar but allow scroll */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        /* Travel Line Dashed Effect */
        .travel-line {
            background-image: linear-gradient(to bottom, #3f3f46 50%, transparent 50%);
            background-size: 2px 10px;
            background-repeat: repeat-y;
        }
    </style>
</head>
<body class="pb-24">

    <!-- Header & Day Selector -->
    <header class="sticky top-0 z-40 bg-[#0a0a0a]/90 backdrop-blur-md border-b border-neutral-800 shadow-lg">
        <div class="px-5 py-3 flex justify-between items-center max-w-md mx-auto">
            <div>
                <h1 class="text-lg font-bold tracking-wider text-white">2026 冬の関東旅</h1>
                <p class="text-[10px] text-neutral-500 font-mono tracking-widest">TOKYO • NIIGATA • HAKONE</p>
            </div>
            <div class="w-8 h-8 rounded-full bg-rose-700 flex items-center justify-center text-white font-bold text-xs shadow-rose-900/50 shadow-lg border border-rose-500/30">
                JP
            </div>
        </div>

        <!-- Horizontal Scroll Day Selector -->
        <div id="day-selector" class="flex overflow-x-auto gap-3 pb-3 px-5 max-w-md mx-auto no-scrollbar scroll-smooth">
            <!-- JS will inject days here -->
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-md mx-auto px-5 pt-6 min-h-screen">
        
        <!-- Itinerary Section -->
        <div id="itinerary-view" class="transition-opacity duration-300">
            <!-- Day Summary Header -->
            <div id="day-header" class="mb-6">
                <!-- JS Injected -->
            </div>

            <!-- Timeline -->
            <div id="timeline-container" class="space-y-0 relative">
                <!-- JS Injected -->
            </div>
        </div>

        <!-- Info Section (Hidden by default) -->
        <div id="info-view" class="hidden animate-fade-in">
            <!-- JS Injected -->
        </div>

        <!-- Budget Section (Hidden by default) -->
        <div id="budget-view" class="hidden animate-fade-in">
             <!-- JS Injected -->
        </div>

    </main>

    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 w-full bg-[#0a0a0a]/95 backdrop-blur-xl border-t border-neutral-800 z-50 pb-safe">
        <div class="max-w-md mx-auto flex justify-around items-center h-16 px-2">
            <button onclick="switchTab('itinerary')" class="nav-btn group flex flex-col items-center justify-center w-16 h-full space-y-1.5" data-tab="itinerary">
                <i data-lucide="calendar" class="w-5 h-5 text-rose-500 transition-colors group-active:scale-90"></i>
                <span class="text-[10px] font-medium text-rose-500">行程</span>
            </button>
            <button onclick="switchTab('info')" class="nav-btn group flex flex-col items-center justify-center w-16 h-full space-y-1.5" data-tab="info">
                <i data-lucide="info" class="w-5 h-5 text-neutral-600 transition-colors group-active:scale-90"></i>
                <span class="text-[10px] font-medium text-neutral-600">資訊</span>
            </button>
            <button onclick="switchTab('budget')" class="nav-btn group flex flex-col items-center justify-center w-16 h-full space-y-1.5" data-tab="budget">
                <i data-lucide="credit-card" class="w-5 h-5 text-neutral-600 transition-colors group-active:scale-90"></i>
                <span class="text-[10px] font-medium text-neutral-600">預算</span>
            </button>
        </div>
    </nav>

    <!-- Detail Modal -->
    <div id="detail-modal" class="fixed inset-0 z-[60] hidden items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/90 backdrop-blur-sm transition-opacity" onclick="closeModal()"></div>
        <div class="relative w-full max-w-sm bg-neutral-900 rounded-2xl shadow-2xl overflow-hidden border border-neutral-700 transform transition-all scale-100">
            
            <button onclick="closeModal()" class="absolute top-3 right-3 z-10 p-2 bg-black/50 rounded-full text-white backdrop-blur hover:bg-black/70">
                <i data-lucide="x" class="w-5 h-5"></i>
            </button>

            <!-- Image Area -->
            <div class="h-56 w-full bg-neutral-800 relative">
                <img id="modal-image" src="" alt="Spot" class="w-full h-full object-cover opacity-90">
                <div class="absolute bottom-0 left-0 w-full h-24 bg-gradient-to-t from-neutral-900 to-transparent"></div>
                <div id="modal-tags" class="absolute bottom-4 left-4 flex gap-2"></div>
            </div>

            <!-- Content -->
            <div class="p-6">
                <h2 id="modal-title" class="text-xl font-bold text-white mb-1 flex items-center"></h2>
                <div class="flex items-center text-neutral-400 text-xs mb-4">
                    <i data-lucide="clock" class="w-3 h-3 mr-1"></i>
                    <span id="modal-time"></span>
                </div>
                
                <div class="bg-neutral-800/50 p-4 rounded-xl border border-neutral-700/50 mb-6">
                    <h4 class="text-[10px] font-bold text-neutral-500 uppercase tracking-wider mb-2">詳細介紹</h4>
                    <p id="modal-desc" class="text-sm text-neutral-300 leading-relaxed"></p>
                </div>

                <a id="modal-nav-btn" href="#" target="_blank" class="w-full py-3 bg-rose-700 hover:bg-rose-600 active:bg-rose-800 text-white rounded-xl font-medium flex items-center justify-center transition-colors shadow-lg shadow-rose-900/20">
                    <i data-lucide="navigation" class="w-4 h-4 mr-2"></i>
                    開啟 Google 導航
                </a>
            </div>
        </div>
    </div>

    <!-- JavaScript Data & Logic -->
    <script>
        // --- Data ---
        const tripData = {
            days: [
                {
                    id: 1, date: "2/8", dayNum: "Day 1",
                    location: "台北 ✈ 東京", weather: "6°C 多雲", hotel: "東橫INN 成田機場本館",
                    timeline: [
                        { time: "12:50", title: "起飛 TPE", desc: "捷星航空 GK14 (T1)", longDesc: "於桃園國際機場第一航廈辦理登機。建議提早 2.5 小時抵達機場。", type: "transport", image: "捷星航空", travelNext: { time: "3h 5m", dist: "2,100km" } },
                        { time: "16:55", title: "抵達 NRT", desc: "成田機場 (T3)", longDesc: "抵達東京成田機場第三航廈。入境後請依照指示前往接駁巴士站。", type: "transport", image: "成田機場", travelNext: { time: "15m", dist: "接駁車" } },
                        { time: "18:00", title: "飯店 Check-in", desc: "東橫INN 成田機場 本館", longDesc: "提供往返機場的免費接駁巴士。飯店內設有大浴場。", type: "stay", link: "東橫INN成田機場本館", image: "東橫INN" }
                    ]
                },
                {
                    id: 2, date: "2/9", dayNum: "Day 2",
                    location: "成田 ➜ 水戶", weather: "5°C 晴時多雲", hotel: "Dormy Inn 水戶",
                    timeline: [
                        { time: "09:00", title: "取車出發", desc: "Toyota Rent a Car 成田機場店", longDesc: "預約車型：Toyota Sienta。請檢查車身傷痕，確認ETC卡與雪胎。", type: "car", link: "Toyota Rent a Car Narita Airport", image: "Toyota Sienta", travelNext: { time: "1h 30m", dist: "100km" } },
                        { time: "10:30", title: "袋田瀑布", desc: "日本三大名瀑，欣賞冰瀑。", longDesc: "高120米、寬73米。冬季結冰形成壯觀的「冰瀑」。", type: "sight", link: "袋田瀑布", tags: ["必看"], image: "袋田瀑布", travelNext: { time: "1h", dist: "55km" } },
                        { time: "12:45", title: "午餐：鮟鱇魚鍋", desc: "推薦：元祖鮟鱇魚鍋 山翠。", longDesc: "茨城冬季代表美食。將魚肝溶入味噌湯底，風味濃郁。", type: "food", tags: ["必吃"], link: "山翠 水戶", image: "鮟鱇魚鍋", travelNext: { time: "10m", dist: "市區" } },
                        { time: "14:30", title: "偕樂園", desc: "日本三大名園，梅花祭。", longDesc: "園內3000株梅花盛開。好文亭可俯瞰千波湖美景。", type: "sight", link: "偕樂園", image: "偕樂園", travelNext: { time: "15m", dist: "市區" } },
                        { time: "18:30", title: "晚餐：常陸牛", desc: "推薦：飯島餐廳 或 和牛庵。", longDesc: "茨城縣產高級黑毛和牛，肉質細膩脂肪甘甜。", type: "food", tags: ["必吃"], link: "Restaurant Iijima Mito", image: "常陸牛" }
                    ]
                },
                {
                    id: 3, date: "2/10", dayNum: "Day 3",
                    location: "水戶 ➜ 日光", weather: "0°C 山區降雪", hotel: "東橫INN 宇都宮站前",
                    timeline: [
                        { time: "09:20", title: "常陸國出雲大社", desc: "祈求結緣，巨大注連繩。", longDesc: "拜殿掛有重達6噸的巨大注連繩，非常壯觀。", type: "sight", link: "常陸國出雲大社", image: "常陸國出雲大社", travelNext: { time: "1h 30m", dist: "90km" } },
                        { time: "13:30", title: "日光東照宮", desc: "世界遺產，必看三猿。", longDesc: "供奉德川家康，建築金碧輝煌。著名的「三猿」就在神廄舍。", type: "sight", link: "日光東照宮", image: "日光東照宮", travelNext: { time: "40m", dist: "18km (山路)" } },
                        { time: "15:40", title: "華嚴瀑布", desc: "經伊呂波坂上山，欣賞冰瀑。", longDesc: "落差97公尺。伊呂波坂有48個急彎，請小心駕駛。", type: "sight", tags: ["注意駕駛"], link: "華嚴瀑布", image: "華嚴瀑布", travelNext: { time: "1h", dist: "50km" } },
                        { time: "18:30", title: "宇都宮餃子", desc: "推薦：來らっせ (Kirasse)。", longDesc: "集合當地五家名店，一次吃到不同口味的餃子。", type: "food", tags: ["必吃"], link: "Kirasse Main Store", image: "宇都宮餃子" }
                    ]
                },
                {
                    id: 4, date: "2/11", dayNum: "Day 4",
                    location: "宇都宮 ➜ 南魚沼", weather: "-2°C 大雪", hotel: "坂戶城 (六日町溫泉)",
                    timeline: [
                        { time: "10:30", title: "少林山達摩寺", desc: "達摩發源地。", longDesc: "寺內堆滿了還願的達摩。可在此購買達摩許願。", type: "sight", tags: ["必買"], link: "少林山達摩寺", image: "少林山達摩寺", travelNext: { time: "20m", dist: "8km" } },
                        { time: "11:30", title: "登利平 鳥飯", desc: "群馬縣民靈魂美食。", longDesc: "薄切雞胸肉淋上秘傳醬汁，簡單卻令人回味。", type: "food", tags: ["必吃"], link: "登利平 本店", image: "登利平鳥飯", travelNext: { time: "1h 40m", dist: "110km" } },
                        { time: "14:30", title: "魚沼之里", desc: "八海山酒造，參觀雪室。", longDesc: "利用冬季積雪冷藏清酒。園區內景色優美。", type: "sight", link: "魚沼之里", image: "魚沼之里", travelNext: { time: "20m", dist: "10km" } },
                        { time: "18:00", title: "南魚沼晚餐", desc: "推薦：欅亭(洋食) 或 魚沼釜蔵。", longDesc: "南魚沼越光米日本第一。米飯極其美味。", type: "food", tags: ["必吃"], link: "Keyakitei Minamiuonuma", image: "越光米" }
                    ]
                },
                {
                    id: 5, date: "2/12", dayNum: "Day 5",
                    location: "南魚沼 ➜ 新潟", weather: "3°C 雨夾雪", hotel: "東橫INN 新潟站前",
                    timeline: [
                        { time: "09:45", title: "三条鍛冶道場", desc: "職人指導製作拆信刀。", longDesc: "體驗將五寸釘鍛造成拆信刀，非常有紀念價值。", type: "activity", tags: ["體驗"], link: "Sanjo Blacksmith Dojo", image: "三条鍛冶道場", travelNext: { time: "30m", dist: "20km" } },
                        { time: "13:00", title: "彌彥神社", desc: "新潟最強能量景點。", longDesc: "越後國一之宮，氣氛莊嚴。可搭纜車上彌彥山。", type: "sight", link: "彌彥神社", image: "彌彥神社", travelNext: { time: "50m", dist: "40km" } },
                        { time: "15:30", title: "Pier Bandai", desc: "萬代市場，海鮮採買。", longDesc: "有迴轉壽司名店「弁慶」、新鮮海產與地酒。", type: "shopping", tags: ["必買"], link: "Pier Bandai", image: "Pier Bandai", travelNext: { time: "15m", dist: "市區" } },
                        { time: "18:00", title: "醬汁豬排丼", desc: "推薦：炸豬排太郎。", longDesc: "薄豬排浸泡在甜鹹醬汁中，不加蛋液。", type: "food", tags: ["必吃"], link: "Tonkatsu Taro Niigata", image: "醬汁豬排丼" }
                    ]
                },
                {
                    id: 6, date: "2/13", dayNum: "Day 6",
                    location: "新潟 ➜ 長野", weather: "1°C 多雲時雪", hotel: "東橫INN 長野站東口",
                    timeline: [
                        { time: "09:00", title: "出發移動", desc: "前往地獄谷", type: "car", image: "雪地自駕", travelNext: { time: "2h 30m", dist: "160km" } },
                        { time: "11:30", title: "Enza Cafe", desc: "步道口，雞白湯拉麵。", longDesc: "在寒冷天氣爬山前後，來一碗熱拉麵非常療癒。", type: "food", link: "Enza Cafe Jigokudani", image: "Enza Cafe", travelNext: { time: "30m", dist: "步行" } },
                        { time: "13:20", title: "地獄谷野猿公苑", desc: "世界唯一雪猴泡溫泉。", longDesc: "觀賞野生獼猴在雪地泡湯。需步行約30分鐘山路。", type: "sight", tags: ["必看"], link: "Jigokudani Monkey Park", image: "雪猴泡溫泉", travelNext: { time: "50m", dist: "35km" } },
                        { time: "18:00", title: "味噌家", desc: "長野站旁，味噌拉麵。", longDesc: "使用信州味噌製作湯頭，搭配大量炒豆芽。", type: "food", tags: ["必吃"], link: "Misoya Nagano Station", image: "味噌拉麵" }
                    ]
                },
                {
                    id: 7, date: "2/14", dayNum: "Day 7",
                    location: "長野 ➜ 甲府", weather: "4°C 晴朗", hotel: "Dormy Inn 甲府丸之內",
                    timeline: [
                        { time: "10:15", title: "穂高神社", desc: "交通安全守護神。", longDesc: "日本阿爾卑斯總鎮守，自駕必拜。", type: "sight", link: "Hotaka Shrine", image: "穂高神社", travelNext: { time: "1h 15m", dist: "60km" } },
                        { time: "11:30", title: "信州蕎麥麵", desc: "推薦：Soba-dokoro Kamijo。", longDesc: "安曇野水質好，蕎麥麵特別Q彈。", type: "food", tags: ["必吃"], link: "Soba-dokoro Kamijo", image: "信州蕎麥麵", travelNext: { time: "45m", dist: "40km" } },
                        { time: "14:00", title: "立石公園", desc: "《你的名字》系守湖原型。", longDesc: "俯瞰諏訪湖全景，分身之時場景靈感。", type: "sight", tags: ["聖地巡禮"], link: "Tateishi Park Suwa", image: "立石公園", travelNext: { time: "1h", dist: "60km" } },
                        { time: "18:30", title: "甲府餺飥麵", desc: "推薦：小作。", longDesc: "寬扁麵條與南瓜味噌燉煮，山梨鄉土料理。", type: "food", tags: ["必吃"], link: "Kosaku Kofu Station", image: "餺飥麵" }
                    ]
                },
                {
                    id: 8, date: "2/15", dayNum: "Day 8",
                    location: "甲府 ➜ 箱根", weather: "5°C 多雲", hotel: "小田原住宿",
                    timeline: [
                        { time: "10:00", title: "大石公園", desc: "河口湖，富士山絕景。", longDesc: "拍攝富士山與湖景的經典位置。", type: "sight", tags: ["拍照"], link: "Oishi Park", image: "大石公園", travelNext: { time: "20m", dist: "10km" } },
                        { time: "11:30", title: "吉田烏龍麵", desc: "推薦：蔵ノ介。", longDesc: "全日本最硬烏龍麵，嚼勁十足。", type: "food", tags: ["必吃"], link: "Kuranosuke Yoshida Udon", image: "吉田烏龍麵", travelNext: { time: "1h 30m", dist: "50km" } },
                        { time: "14:00", title: "箱根神社", desc: "水中平和鳥居。", longDesc: "蘆之湖上的紅色鳥居，必拍打卡點。", type: "sight", link: "Hakone Shrine", image: "箱根神社", travelNext: { time: "40m", dist: "20km" } },
                        { time: "18:00", title: "小田原關東煮", desc: "推薦：小田原關東煮本店。", longDesc: "使用高品質魚板，湯頭清淡優雅。", type: "food", tags: ["預約"], link: "Odawara Oden Honten", image: "小田原關東煮" }
                    ]
                },
                {
                    id: 9, date: "2/16", dayNum: "Day 9",
                    location: "小田原 ➜ 橫濱", weather: "9°C 晴朗", hotel: "東橫INN 橫濱體育場前",
                    timeline: [
                        { time: "10:30", title: "鎌倉高校前", desc: "灌籃高手平交道。", longDesc: "江之電與大海背景，經典動畫場景。", type: "sight", tags: ["打卡"], link: "Kamakurakokomae Station", image: "鎌倉高校前", travelNext: { time: "10m", dist: "2km" } },
                        { time: "11:00", title: "Pacific DRIVE-IN", desc: "七里濱海景餐廳。", longDesc: "夏威夷蒜味蝦飯，露台直面江之島。", type: "food", tags: ["必吃"], link: "Pacific DRIVE-IN", image: "Pacific DRIVE-IN", travelNext: { time: "20m", dist: "5km" } },
                        { time: "13:00", title: "鎌倉大佛", desc: "高德院國寶大佛。", longDesc: "露天巨大青銅坐像，可進入內部參觀。", type: "sight", link: "Kamakura Daibutsu", image: "鎌倉大佛", travelNext: { time: "45m", dist: "25km" } },
                        { time: "18:00", title: "橫濱中華街", desc: "日本最大唐人街。", longDesc: "推薦「橫濱大飯店」吃到飽或四川麻婆豆腐。", type: "food", link: "Yokohama Chinatown", image: "橫濱中華街" }
                    ]
                },
                {
                    id: 10, date: "2/17", dayNum: "Day 10",
                    location: "橫濱 ➜ 成田 ✈", weather: "8°C 多雲", hotel: "溫暖的家",
                    timeline: [
                        { time: "09:00", title: "Check-out", desc: "前往機場", type: "transport", image: "Check-out", travelNext: { time: "1h 30m", dist: "100km" } },
                        { time: "13:00", title: "還車", desc: "Toyota Rent a Car 成田", type: "car", link: "Toyota Rent a Car Narita Airport", image: "還車", travelNext: { time: "10m", dist: "接駁" } },
                        { time: "14:00", title: "報到", desc: "成田機場 Check-in", type: "plane", image: "成田機場" },
                        { time: "16:00", title: "起飛", desc: "返回台北", type: "plane", image: "飛機" }
                    ]
                }
            ],
            info: {
                flights: ["GK14 TPE 12:50 ➝ NRT 16:55 (2/8)", "JX801 NRT 13:40 ➝ TPE 16:45 (2/17)"],
                hotels: ["東橫INN 成田機場本館", "Dormy Inn 水戶", "東橫INN 宇都宮站前", "坂戶城 (南魚沼)", "東橫INN 新潟站前", "東橫INN 長野站東口", "Dormy Inn 甲府丸之內", "東橫INN 橫濱體育場前"],
                emergency: [{n:"日本報警",v:"110"},{n:"日本救護",v:"119"},{n:"外交部",v:"080-1009-7179"}]
            },
            budget: [
                { i: "租車 (Toyota Sienta)", c: "¥108,900" },
                { i: "住宿 Day1 (東橫INN)", c: "¥11,495" },
                { i: "免責補償制度", c: "¥9,900" },
                { i: "ETC 過路費 (預估)", c: "¥15,000" },
                { i: "油資 (預估)", c: "¥8,000" }
            ]
        };

        // --- Global State ---
        let currentDayId = 1;

        // --- DOM Elements ---
        const daySelector = document.getElementById('day-selector');
        const dayHeader = document.getElementById('day-header');
        const timelineContainer = document.getElementById('timeline-container');
        const detailModal = document.getElementById('detail-modal');
        const itineraryView = document.getElementById('itinerary-view');
        const infoView = document.getElementById('info-view');
        const budgetView = document.getElementById('budget-view');

        // --- Initialization ---
        function init() {
            renderDaySelector();
            renderDay(1);
            lucide.createIcons();
        }

        // --- Render Functions ---
        function renderDaySelector() {
            daySelector.innerHTML = tripData.days.map(day => `
                <button onclick="selectDay(${day.id})" 
                    class="day-btn flex-shrink-0 flex flex-col items-center justify-center min-w-[4.5rem] py-2 rounded-xl border transition-all duration-200 ${day.id === currentDayId ? 'bg-rose-900/40 text-rose-200 border-rose-700 shadow-md shadow-rose-900/20' : 'bg-neutral-900 text-neutral-500 border-neutral-800'}" 
                    data-id="${day.id}">
                    <span class="text-[10px] font-bold tracking-wider uppercase mb-0.5">${day.dayNum}</span>
                    <span class="text-xs font-medium">${day.date}</span>
                </button>
            `).join('');
        }

        function selectDay(id) {
            currentDayId = id;
            
            // Update Buttons Styles
            document.querySelectorAll('.day-btn').forEach(btn => {
                if(parseInt(btn.dataset.id) === id) {
                    btn.className = "day-btn flex-shrink-0 flex flex-col items-center justify-center min-w-[4.5rem] py-2 rounded-xl border transition-all duration-200 bg-rose-900/40 text-rose-200 border-rose-700 shadow-md shadow-rose-900/20 scale-105";
                } else {
                    btn.className = "day-btn flex-shrink-0 flex flex-col items-center justify-center min-w-[4.5rem] py-2 rounded-xl border transition-all duration-200 bg-neutral-900 text-neutral-500 border-neutral-800 active:scale-95";
                }
            });

            // Re-render Content with Animation
            const contentDiv = document.getElementById('itinerary-view');
            contentDiv.classList.remove('animate-fade-in');
            void contentDiv.offsetWidth; // trigger reflow
            contentDiv.classList.add('animate-fade-in');
            
            renderDay(id);
        }

        function renderDay(id) {
            const day = tripData.days.find(d => d.id === id);
            
            // Render Header
            dayHeader.innerHTML = `
                <div class="flex items-end justify-between mb-4">
                    <h2 class="text-2xl font-bold text-white tracking-tight">${day.location}</h2>
                    <div class="flex items-center space-x-2 bg-neutral-800/80 px-3 py-1.5 rounded-full border border-neutral-700 backdrop-blur-sm">
                        <i data-lucide="cloud" class="w-4 h-4 text-neutral-400"></i>
                        <span class="text-sm font-medium text-neutral-200">${day.weather}</span>
                    </div>
                </div>
                <div class="flex items-center space-x-2 text-xs text-neutral-400 bg-neutral-900/50 p-3 rounded-xl border border-neutral-800 backdrop-blur-sm">
                    <i data-lucide="bed-double" class="w-4 h-4 text-rose-400"></i>
                    <span>${day.hotel}</span>
                </div>
            `;

            // Render Timeline
            timelineContainer.innerHTML = day.timeline.map((item, index) => {
                let iconColor = "text-neutral-400";
                if(item.type === 'food') iconColor = "text-orange-400";
                if(item.type === 'sight') iconColor = "text-emerald-400";
                if(item.type === 'car') iconColor = "text-blue-400";
                if(item.type === 'activity') iconColor = "text-purple-400";

                let travelHtml = '';
                if (item.travelNext) {
                    travelHtml = `
                        <div class="absolute left-[11px] top-14 bottom-0 w-[2px] travel-line z-0"></div>
                        <div class="pl-12 py-3">
                            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-neutral-900 border border-neutral-800 text-[10px] text-neutral-500">
                                <i data-lucide="car" class="w-3 h-3"></i>
                                <span>${item.travelNext.time}</span>
                                <span class="w-0.5 h-2 bg-neutral-700"></span>
                                <span>${item.travelNext.dist}</span>
                            </div>
                        </div>
                    `;
                }

                return `
                    <div class="relative group">
                        <div class="pl-4 py-2 cursor-pointer transition-transform active:scale-[0.99]" onclick='openModal(${JSON.stringify(item)})'>
                            <!-- Dot -->
                            <div class="absolute left-0 top-6 w-6 h-6 rounded-full bg-neutral-900 border-2 border-neutral-700 flex items-center justify-center z-10 shadow-sm shadow-black">
                                <i data-lucide="${getIconType(item.type)}" class="w-3 h-3 ${iconColor}"></i>
                            </div>
                            
                            <!-- Card -->
                            <div class="ml-8 bg-neutral-900/80 p-4 rounded-xl border border-neutral-800/80 hover:bg-neutral-800 hover:border-neutral-700 transition-colors shadow-sm">
                                <div class="flex justify-between items-start mb-1">
                                    <span class="text-xs font-mono text-neutral-500 bg-neutral-950/50 px-1.5 py-0.5 rounded">${item.time}</span>
                                    ${item.tags ? item.tags.map(t => `<span class="text-[10px] px-2 py-0.5 rounded-full border border-rose-900/50 bg-rose-950/30 text-rose-300 ml-2">${t}</span>`).join('') : ''}
                                </div>
                                <h3 class="text-base font-bold text-neutral-200 mb-1">${item.title}</h3>
                                <p class="text-xs text-neutral-400 line-clamp-1">${item.desc}</p>
                            </div>
                        </div>
                        ${travelHtml}
                    </div>
                `;
            }).join('');

            lucide.createIcons();
        }

        function getIconType(type) {
            if(type === 'food') return 'utensils';
            if(type === 'car' || type === 'transport') return 'car';
            if(type === 'sight') return 'camera';
            if(type === 'stay') return 'bed-double';
            if(type === 'plane') return 'plane';
            if(type === 'shopping') return 'shopping-bag';
            return 'map-pin';
        }

        // --- Tabs Logic ---
        function switchTab(tabName) {
            // Update active state visuals
            document.querySelectorAll('.nav-btn i').forEach(el => el.classList.replace('text-rose-500', 'text-neutral-600'));
            document.querySelectorAll('.nav-btn span').forEach(el => el.classList.replace('text-rose-500', 'text-neutral-600'));
            
            const activeBtn = document.querySelector(`button[data-tab="${tabName}"]`);
            activeBtn.querySelector('i').classList.replace('text-neutral-600', 'text-rose-500');
            activeBtn.querySelector('span').classList.replace('text-neutral-600', 'text-rose-500');

            // Hide all views
            itineraryView.classList.add('hidden');
            infoView.classList.add('hidden');
            budgetView.classList.add('hidden');

            // Logic to render simple views
            if(tabName === 'info') {
                renderInfo();
                infoView.classList.remove('hidden');
            } else if (tabName === 'budget') {
                renderBudget();
                budgetView.classList.remove('hidden');
            } else {
                itineraryView.classList.remove('hidden');
            }
        }

        function renderInfo() {
            if(infoView.innerHTML.trim() !== "") return; 
            infoView.innerHTML = `
                <div class="bg-neutral-900 p-5 rounded-2xl border border-neutral-800 mb-4">
                    <h3 class="text-sm font-bold text-neutral-200 mb-3 flex items-center"><i data-lucide="plane" class="w-4 h-4 mr-2"></i> 航班資訊</h3>
                    ${tripData.info.flights.map(f => `<div class="text-xs text-neutral-400 py-2 border-b border-neutral-800 last:border-0">${f}</div>`).join('')}
                </div>
                <div class="bg-neutral-900 p-5 rounded-2xl border border-neutral-800 mb-4">
                    <h3 class="text-sm font-bold text-neutral-200 mb-3 flex items-center"><i data-lucide="bed-double" class="w-4 h-4 mr-2"></i> 住宿列表</h3>
                    ${tripData.info.hotels.map(h => `<div class="text-xs text-neutral-400 py-2 border-b border-neutral-800 last:border-0">${h}</div>`).join('')}
                </div>
                <div class="grid grid-cols-3 gap-2">
                    ${tripData.info.emergency.map(e => `
                        <div class="bg-rose-950/20 border border-rose-900/30 p-3 rounded-xl text-center">
                            <div class="text-[10px] text-rose-300 mb-1">${e.n}</div>
                            <div class="text-sm font-bold text-rose-500">${e.v}</div>
                        </div>
                    `).join('')}
                </div>
            `;
            lucide.createIcons();
        }

        function renderBudget() {
            if(budgetView.innerHTML.trim() !== "") return;
            budgetView.innerHTML = `
                <div class="bg-neutral-900 rounded-2xl border border-neutral-800 overflow-hidden">
                    <div class="p-4 bg-neutral-800/50 border-b border-neutral-800">
                        <h3 class="font-bold text-neutral-200 flex items-center"><i data-lucide="credit-card" class="w-4 h-4 mr-2"></i> 預算概覽</h3>
                    </div>
                    <div class="divide-y divide-neutral-800">
                        ${tripData.budget.map(b => `
                            <div class="p-4 flex justify-between items-center">
                                <span class="text-xs text-neutral-400">${b.i}</span>
                                <span class="font-mono font-bold text-neutral-200 text-sm">${b.c}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            lucide.createIcons();
        }

        // --- Modal Logic ---
        function openModal(item) {
            document.getElementById('modal-title').innerText = item.title;
            document.getElementById('modal-desc').innerText = item.longDesc || item.desc;
            document.getElementById('modal-time').innerText = item.time;
            
            // Image
            const imgUrl = item.image ? `https://placehold.co/600x400/171717/525252?text=${item.image}` : `https://placehold.co/600x400/171717/525252?text=${item.title}`;
            document.getElementById('modal-image').src = imgUrl;

            // Nav Button
            const navBtn = document.getElementById('modal-nav-btn');
            if(item.link) {
                navBtn.href = `https://www.google.com/maps/search/?api=1&query=${item.link}`;
                navBtn.classList.remove('hidden');
                navBtn.classList.add('flex');
            } else {
                navBtn.classList.add('hidden');
                navBtn.classList.remove('flex');
            }

            // Tags
            const tagsContainer = document.getElementById('modal-tags');
            tagsContainer.innerHTML = item.tags ? item.tags.map(t => `<span class="text-[10px] px-2 py-0.5 rounded-full bg-rose-600 text-white shadow-sm">${t}</span>`).join('') : '';

            detailModal.classList.remove('hidden');
            detailModal.classList.add('flex');
        }

        function closeModal() {
            detailModal.classList.add('hidden');
            detailModal.classList.remove('flex');
        }

        // Run
        init();

    </script>
</body>
</html>

